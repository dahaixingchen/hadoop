<svg id="SvgjsSvg1006" width="1185.3333740234375" height="1385.3500518798828" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1037" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1038" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1064" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1065" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1074" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1075" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1100" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1101" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1114" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1115" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1128" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1129" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1153" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1154" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1163" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1164" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1173" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1174" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1227" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1228" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1231" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1232" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1235" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1236" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1239" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1240" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1245" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1246" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1255" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1256" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1259" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1260" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1288" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1289" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1008" transform="translate(35.79998779296875,35.99999237060547)"><path id="SvgjsPath1009" d="M 48.566673278808594 30L 48.566673278808594 1312.809534890311" stroke-dasharray="3,4" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1010" d="M 0 0L 97.13334655761719 0L 97.13334655761719 30L 0 30Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1011"><text id="SvgjsText1012" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="78px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="5.05" transform="rotate(0)"><tspan id="SvgjsTspan1013" dy="16" x="49"><tspan id="SvgjsTspan1014" style="text-decoration:;">MapTask</tspan></tspan></text></g></g><g id="SvgjsG1015" transform="translate(71.93333435058594,89.99999237060547)"><path id="SvgjsPath1016" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 1096.5333557128906Q 30 1100.5333557128906 26 1100.5333557128906L 4 1100.5333557128906Q 0 1100.5333557128906 0 1096.5333557128906L 0 4Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1017" transform="translate(537.9333343505859,24.99999237060547)"><path id="SvgjsPath1018" d="M 68.5 30L 68.5 780.9999694824219" stroke-dasharray="3,4" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1019" d="M 0 0L 137 0L 137 30L 0 30Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1020"><text id="SvgjsText1021" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="117px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="5.05" transform="rotate(0)"><tspan id="SvgjsTspan1022" dy="16" x="68.5"><tspan id="SvgjsTspan1023" style="text-decoration:;">TextInputformat</tspan></tspan></text></g></g><g id="SvgjsG1024" transform="translate(591.4333343505859,393.99999237060547)"><path id="SvgjsPath1025" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 178.00000381469727Q 30 182.00000381469727 26 182.00000381469727L 4 182.00000381469727Q 0 182.00000381469727 0 178.00000381469727L 0 4Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1026" transform="translate(767.5333251953125,27.66661834716797)"><path id="SvgjsPath1027" d="M 69.13333129882812 30L 69.13333129882812 775.6667175292969" stroke-dasharray="3,4" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1028" d="M 0 0L 138.26666259765625 0L 138.26666259765625 30L 0 30Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1029"><text id="SvgjsText1030" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="119px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="5.05" transform="rotate(0)"><tspan id="SvgjsTspan1031" dy="16" x="69.5"><tspan id="SvgjsTspan1032" style="text-decoration:;">LineRecordReader</tspan></tspan></text></g></g><g id="SvgjsG1033" transform="translate(816.7333297729492,545.9999961853027)"><path id="SvgjsPath1034" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 196.8095272609164Q 30 200.8095272609164 26 200.8095272609164L 4 200.8095272609164Q 0 200.8095272609164 0 196.8095272609164L 0 4Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1035"><path id="SvgjsPath1036" d="M99.79998779296875 130.35157442078162L129.79998779296875 130.35157442078162L131.79998779296875 274.92743435865157L101.79998779296875 274.92743435865157" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1037)"></path><rect id="SvgjsRect1039" width="30" height="16" x="115.79998779296875" y="194.6395043897166" fill="#ffffff"></rect><text id="SvgjsText1040" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="30px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="192.6895043897166" transform="rotate(0)"><tspan id="SvgjsTspan1041" dy="16" x="130.79998779296875"><tspan id="SvgjsTspan1042" style="text-decoration:;">run()</tspan></tspan></text></g><g id="SvgjsG1043" transform="translate(217.349658265406,49.95236968994067)"><path id="SvgjsPath1044" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1045" d="M 284.63809858049626 0L 284.63809858049626 16L 300.63809858049626 16" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1046" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1047"><text id="SvgjsText1048" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="281px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="6.873810577392606" transform="rotate(0)"><tspan id="SvgjsTspan1049" dy="16" x="150.5"><tspan id="SvgjsTspan1050" style="text-decoration:;">我们在写MR任务的时候，一般必须写的就是</tspan></tspan><tspan id="SvgjsTspan1051" dy="16" x="150.5"><tspan id="SvgjsTspan1052" style="text-decoration:;">Map和Reduce类，我们点进继承类Mapper类，</tspan></tspan><tspan id="SvgjsTspan1053" dy="16" x="150.5"><tspan id="SvgjsTspan1054" style="text-decoration:;">观察发现，里面有个run()方法是整个类的重点，</tspan></tspan><tspan id="SvgjsTspan1055" dy="16" x="150.5"><tspan id="SvgjsTspan1056" style="text-decoration:;">包括我们map方法也是它调起的。</tspan><tspan id="SvgjsTspan1057" style="text-decoration:;font-weight: bold;fill: rgb(255, 0, 0);">由他我们找下</tspan></tspan><tspan id="SvgjsTspan1058" dy="16" x="150.5"><tspan id="SvgjsTspan1059" style="text-decoration:;font-weight: bold;fill: rgb(255, 0, 0);">MapTask类中对应的run()它对应的也应该整个</tspan></tspan><tspan id="SvgjsTspan1060" dy="16" x="150.5"><tspan id="SvgjsTspan1061" style="text-decoration:;font-weight: bold;fill: rgb(255, 0, 0);">map环节的重点</tspan></tspan></text></g></g><g id="SvgjsG1062"><path id="SvgjsPath1063" d="M101.79998779296875 300.731264388926L131.79998779296875 300.731264388926L129.79998779296875 420.71907402970163L99.79998779296875 420.71907402970163" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1064)"></path><rect id="SvgjsRect1066" width="107" height="32" x="77.29998779296875" y="344.7251692093138" fill="#ffffff"></rect><text id="SvgjsText1067" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="107px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="342.7751692093138" transform="rotate(0)"><tspan id="SvgjsTspan1068" dy="16" x="130.79998779296875"><tspan id="SvgjsTspan1069" style="text-decoration:;">runNewMapper()</tspan></tspan><tspan id="SvgjsTspan1070" dy="16" x="130.79998779296875"><tspan id="SvgjsTspan1071" style="text-decoration:;">真正跑map的</tspan></tspan></text></g><g id="SvgjsG1072"><path id="SvgjsPath1073" d="M101.79998779296875 442.22227720554025L342.89998626708984 442.22227720554025L342.89998626708984 422.53331756591797L583.9999847412109 422.53331756591797" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1074)"></path><rect id="SvgjsRect1076" width="241" height="48" x="222.39998626708984" y="408.3777973857291" fill="#ffffff"></rect><text id="SvgjsText1077" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="241px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="406.4277973857291" transform="rotate(0)"><tspan id="SvgjsTspan1078" dy="16" x="342.89998626708984"><tspan id="SvgjsTspan1079" style="text-decoration:;">NewTrackingRecordReader</tspan></tspan><tspan id="SvgjsTspan1080" dy="16" x="342.89998626708984"><tspan id="SvgjsTspan1081" style="text-decoration:;">内部类构造方法中调用</tspan></tspan><tspan id="SvgjsTspan1082" dy="16" x="342.89998626708984"><tspan id="SvgjsTspan1083" style="text-decoration:;">createRecordReader(split, taskContext)</tspan></tspan></text></g><g id="SvgjsG1084" transform="translate(232.349658265406,221.35237121582026)"><path id="SvgjsPath1085" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1086" d="M 284.63809858049626 0L 284.63809858049626 16L 300.63809858049626 16" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1087" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1088"><text id="SvgjsText1089" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="281px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="22.873810577392607" transform="rotate(0)"><tspan id="SvgjsTspan1090" dy="16" x="150.5"><tspan id="SvgjsTspan1091" style="text-decoration:;">接下来由mapper端的两个环节：</tspan></tspan><tspan id="SvgjsTspan1092" dy="16" x="150.5"><tspan id="SvgjsTspan1093" style="text-decoration:;">1. RecordReader环节</tspan></tspan><tspan id="SvgjsTspan1094" dy="16" x="150.5"><tspan id="SvgjsTspan1095" style="text-decoration:;">2. RecordWrite环节</tspan></tspan><tspan id="SvgjsTspan1096" dy="16" x="150.5"><tspan id="SvgjsTspan1097" style="text-decoration:;">由它们完成map端对应的功能语义实现</tspan></tspan></text></g></g><g id="SvgjsG1098"><path id="SvgjsPath1099" d="M620.7999877929688 409.0575489338175L650.7999877929688 409.0575489338175L650.7999877929688 544.9999961853027L620.7999877929688 544.9999961853027" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1100)"></path><rect id="SvgjsRect1102" width="178" height="64" x="561.7999877929688" y="445.02877255956014" fill="#ffffff"></rect><text id="SvgjsText1103" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="178px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="443.07877255956015" transform="rotate(0)"><tspan id="SvgjsTspan1104" dy="16" x="650.7999877929688"><tspan id="SvgjsTspan1105" style="text-decoration:;">createRecordReader()</tspan></tspan><tspan id="SvgjsTspan1106" dy="16" x="650.7999877929688"><tspan id="SvgjsTspan1107" style="text-decoration:;">方法返回一个</tspan></tspan><tspan id="SvgjsTspan1108" dy="16" x="650.7999877929688"><tspan id="SvgjsTspan1109" style="text-decoration:;">LineRecordReader这是真正的</tspan></tspan><tspan id="SvgjsTspan1110" dy="16" x="650.7999877929688"><tspan id="SvgjsTspan1111" style="text-decoration:;">到目前发现map读取的类</tspan></tspan></text></g><g id="SvgjsG1112"><path id="SvgjsPath1113" d="M100.99998474121094 624.8666610717773L454.99998474121094 624.8666610717773L454.99998474121094 627.8666610717773L808.9999847412109 627.8666610717773" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1114)"></path><rect id="SvgjsRect1116" width="308" height="64" x="300.99998474121094" y="594.3666610717773" fill="#ffffff"></rect><text id="SvgjsText1117" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="308px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="592.4166610717773" transform="rotate(0)"><tspan id="SvgjsTspan1118" dy="16" x="454.99998474121094"><tspan id="SvgjsTspan1119" style="text-decoration:;">initialize()</tspan></tspan><tspan id="SvgjsTspan1120" dy="16" x="454.99998474121094"><tspan id="SvgjsTspan1121" style="text-decoration:;">对RecordReader读取器</tspan></tspan><tspan id="SvgjsTspan1122" dy="16" x="454.99998474121094"><tspan id="SvgjsTspan1123" style="text-decoration:;">进行初始化</tspan></tspan><tspan id="SvgjsTspan1124" dy="16" x="454.99998474121094"><tspan id="SvgjsTspan1125" style="text-decoration:;">根据上面我们知道应该找它的子类LineRecordReader</tspan></tspan></text></g><g id="SvgjsG1126"><path id="SvgjsPath1127" d="M845.7999877929688 572.3333358764648L875.7999877929688 572.3333358764648L875.7999877929688 732.3333358764648L845.7999877929688 732.3333358764648" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1128)"></path><rect id="SvgjsRect1130" width="60" height="16" x="845.7999877929688" y="644.3333358764648" fill="#ffffff"></rect><text id="SvgjsText1131" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="60px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="642.3833358764648" transform="rotate(0)"><tspan id="SvgjsTspan1132" dy="16" x="875.7999877929688"><tspan id="SvgjsTspan1133" style="text-decoration:;">initialize()</tspan></tspan></text></g><g id="SvgjsG1134" transform="translate(860.3496582654061,438.3523712158203)"><path id="SvgjsPath1135" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1136" d="M 284.63809858049626 0L 284.63809858049626 16L 300.63809858049626 16" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1137" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1138"><text id="SvgjsText1139" font-family="微软雅黑" text-anchor="start" font-size="13px" width="281px" fill="#323232" font-weight="400" align="top" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.05" transform="rotate(0)"><tspan id="SvgjsTspan1140" dy="16" x="10"><tspan id="SvgjsTspan1141" style="text-decoration:;">initialize方法实现了以下几个功能</tspan></tspan><tspan id="SvgjsTspan1142" dy="16" x="10"><tspan id="SvgjsTspan1143" style="text-decoration:;">1. 打开hdfs的文件流利用文件的seek()定位到需</tspan></tspan><tspan id="SvgjsTspan1144" dy="16" x="10"><tspan id="SvgjsTspan1145" style="text-decoration:;">要读的位置，</tspan><tspan id="SvgjsTspan1146" style="text-decoration:;font-weight: bold;fill: rgb(255, 0, 0);">是分治思想的具体实现</tspan></tspan><tspan id="SvgjsTspan1147" dy="16" x="10"><tspan id="SvgjsTspan1148" style="text-decoration:;fill: rgb(51, 0, 0);">2. 解决了切片（block块）物理切割会把在同一</tspan></tspan><tspan id="SvgjsTspan1149" dy="16" x="10"><tspan id="SvgjsTspan1150" style="text-decoration:;fill: rgb(51, 0, 0);">行的数据切割成两行的问题</tspan></tspan></text></g></g><g id="SvgjsG1151"><path id="SvgjsPath1152" d="M100.99998474121094 759.5333480834961L130.99998474121094 759.5333480834961L130.99998474121094 850.5333480834961L100.99998474121094 850.5333480834961" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1153)"></path><rect id="SvgjsRect1155" width="201" height="32" x="30.499984741210938" y="789.0333480834961" fill="#ffffff"></rect><text id="SvgjsText1156" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="201px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="787.083348083496" transform="rotate(0)"><tspan id="SvgjsTspan1157" dy="16" x="130.99998474121094"><tspan id="SvgjsTspan1158" style="text-decoration:;">NewOutputCollector()</tspan></tspan><tspan id="SvgjsTspan1159" dy="16" x="130.99998474121094"><tspan id="SvgjsTspan1160" style="text-decoration:;">方法调用createSortingCollector()</tspan></tspan></text></g><g id="SvgjsG1161"><path id="SvgjsPath1162" d="M100.99998474121094 866.5333480834961L130.99998474121094 866.5333480834961L129.99998474121094 951.5333480834961L99.99998474121094 951.5333480834961" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1163)"></path><rect id="SvgjsRect1165" width="155" height="32" x="52.99998474121094" y="893.0333480834961" fill="#ffffff"></rect><text id="SvgjsText1166" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="155px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="891.083348083496" transform="rotate(0)"><tspan id="SvgjsTspan1167" dy="16" x="130.49998474121094"><tspan id="SvgjsTspan1168" style="text-decoration:;">调用MapOutputCollector</tspan></tspan><tspan id="SvgjsTspan1169" dy="16" x="130.49998474121094"><tspan id="SvgjsTspan1170" style="text-decoration:;">接口中的init()方法</tspan></tspan></text></g><g id="SvgjsG1171"><path id="SvgjsPath1172" d="M100.99998474121094 970.8666915893555L130.99998474121094 970.8666915893555L130.99998474121094 1051.8666915893555L100.99998474121094 1051.8666915893555" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1173)"></path><rect id="SvgjsRect1175" width="231" height="48" x="15.499984741210938" y="987.3666915893555" fill="#ffffff"></rect><text id="SvgjsText1176" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="231px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="985.4166915893554" transform="rotate(0)"><tspan id="SvgjsTspan1177" dy="16" x="130.99998474121094"><tspan id="SvgjsTspan1178" style="text-decoration:;">MapOutputCollector的实现是</tspan></tspan><tspan id="SvgjsTspan1179" dy="16" x="130.99998474121094"><tspan id="SvgjsTspan1180" style="text-decoration:;">MapTask类的内部类MapOutputBuffer</tspan></tspan><tspan id="SvgjsTspan1181" dy="16" x="130.99998474121094"><tspan id="SvgjsTspan1182" style="text-decoration:;">调用init()</tspan></tspan></text></g><g id="SvgjsG1183" transform="translate(344.34965826540605,845.3523712158203)"><path id="SvgjsPath1184" d="M 0 0L 512.650326475805 0L 528.650326475805 16L 528.650326475805 295.8476333618164L 0 295.8476333618164L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1185" d="M 512.650326475805 0L 512.650326475805 16L 528.650326475805 16" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1186" d="M 0 0L 512.650326475805 0L 528.650326475805 16L 528.650326475805 295.8476333618164L 0 295.8476333618164L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1187"><text id="SvgjsText1188" font-family="微软雅黑" text-anchor="start" font-size="13px" width="509px" fill="#323232" font-weight="400" align="middle" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1.9738166809082032" transform="rotate(0)"><tspan id="SvgjsTspan1189" dy="16" x="10"><tspan id="SvgjsTspan1190" style="text-decoration:;">init()实现了如下的功能：</tspan></tspan><tspan id="SvgjsTspan1191" dy="16" x="10"><tspan id="SvgjsTspan1192" style="text-decoration:;">1. 定义默认的溢写的比例是80%</tspan></tspan><tspan id="SvgjsTspan1193" dy="16" x="10"><tspan id="SvgjsTspan1194" style="text-decoration:;">    final float spillper =</tspan></tspan><tspan id="SvgjsTspan1195" dy="16" x="10"><tspan id="SvgjsTspan1196" style="text-decoration:;">        job.getFloat(JobContext.MAP_SORT_SPILL_PERCENT, (float)0.8);</tspan></tspan><tspan id="SvgjsTspan1197" dy="16" x="10"><tspan id="SvgjsTspan1198" style="text-decoration:;">2.定义缓存区，默认的大小是100M</tspan></tspan><tspan id="SvgjsTspan1199" dy="16" x="10"><tspan id="SvgjsTspan1200" style="text-decoration:;">    final int sortmb = job.getInt(JobContext.IO_SORT_MB, 100);</tspan></tspan><tspan id="SvgjsTspan1201" dy="16" x="10"><tspan id="SvgjsTspan1202" style="text-decoration:;">3.排序器的排序算法默认的是快速排序：</tspan></tspan><tspan id="SvgjsTspan1203" dy="16" x="10"><tspan id="SvgjsTspan1204" style="text-decoration:;">    sorter = ReflectionUtils.newInstance(job.getClass("map.sort.class",</tspan></tspan><tspan id="SvgjsTspan1205" dy="16" x="10"><tspan id="SvgjsTspan1206" style="text-decoration:;">            QuickSort.class, IndexedSorter.class), job);</tspan></tspan><tspan id="SvgjsTspan1207" dy="16" x="10"><tspan id="SvgjsTspan1208" style="text-decoration:;">4.比较器如果用户没有设置是map端key的比较器：</tspan></tspan><tspan id="SvgjsTspan1209" dy="16" x="10"><tspan id="SvgjsTspan1210" style="text-decoration:;">    return                </tspan></tspan><tspan id="SvgjsTspan1211" dy="16" x="10"><tspan id="SvgjsTspan1212" style="text-decoration:;"> WritableComparator.get(getMapOutputKeyClass().asSubclass(WritableComparab</tspan></tspan><tspan id="SvgjsTspan1213" dy="16" x="10"><tspan id="SvgjsTspan1214" style="text-decoration:;">le.class), this);</tspan></tspan><tspan id="SvgjsTspan1215" dy="16" x="10"><tspan id="SvgjsTspan1216" style="text-decoration:;">5.如果用户设置了combine，就会走combine环节，并设置map溢出小文件3个的时候就</tspan></tspan><tspan id="SvgjsTspan1217" dy="16" x="10"><tspan id="SvgjsTspan1218" style="text-decoration:;">会发生一次combine操作</tspan></tspan><tspan id="SvgjsTspan1219" dy="16" x="10"><tspan id="SvgjsTspan1220" style="text-decoration:;">    minSpillsForCombine = job.getInt(JobContext.MAP_COMBINE_MIN_SPILLS, 3);</tspan></tspan><tspan id="SvgjsTspan1221" dy="16" x="10"><tspan id="SvgjsTspan1222" style="text-decoration:;">6.开启缓冲区溢写线程</tspan></tspan><tspan id="SvgjsTspan1223" dy="16" x="10"><tspan id="SvgjsTspan1224" style="text-decoration:;">    spillThread.start();</tspan></tspan></text></g></g><g id="SvgjsG1225"><path id="SvgjsPath1226" d="M341.99998474121094 1000.2000045776367L288.99998474121094 1000.2000045776367L288.99998474121094 1000.2000045776367L235.99998474121094 1000.2000045776367" stroke-dasharray="10,5,3,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1227)"></path></g><g id="SvgjsG1229"><path id="SvgjsPath1230" d="M944.9999847412109 551.9999923706055L908.9999847412109 551.9999923706055L908.9999847412109 617.2000045776367L872.9999847412109 617.2000045776367" stroke-dasharray="10,5,3,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1231)"></path></g><g id="SvgjsG1233"><path id="SvgjsPath1234" d="M372.99998474121094 342.1999740600586L372.99998474121094 377.1999740600586L372.99998474121094 377.1999740600586L372.99998474121094 412.1999740600586" stroke-dasharray="10,5,3,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1235)"></path></g><g id="SvgjsG1237"><path id="SvgjsPath1238" d="M209.99998474121094 105.86663055419922L155.49998474121094 105.86663055419922L155.49998474121094 105.86663055419922L100.99998474121094 105.86663055419922" stroke-dasharray="10,5,3,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1239)"></path></g><g id="SvgjsG1241" transform="translate(71.93333435058594,1190.533348083496)"><path id="SvgjsPath1242" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 163.66665649414062Q 30 167.66665649414062 26 167.66665649414062L 4 167.66665649414062Q 0 167.66665649414062 0 163.66665649414062L 0 4Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1243"><path id="SvgjsPath1244" d="M100.99998474121094 1090.5333786010742L130.99998474121094 1090.5333786010742L130.99998474121094 1179.5333786010742L100.99998474121094 1179.5333786010742" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1245)"></path><rect id="SvgjsRect1247" width="94" height="32" x="83.99998474121094" y="1119.0333786010742" fill="#ffffff"></rect><text id="SvgjsText1248" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="94px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1117.0833786010742" transform="rotate(0)"><tspan id="SvgjsTspan1249" dy="16" x="130.99998474121094"><tspan id="SvgjsTspan1250" style="text-decoration:;">spillThread类的</tspan></tspan><tspan id="SvgjsTspan1251" dy="16" x="130.99998474121094"><tspan id="SvgjsTspan1252" style="text-decoration:;">run()</tspan></tspan></text></g><g id="SvgjsG1253"><path id="SvgjsPath1254" d="M342.99998474121094 1102.5333786010742L265.99998474121094 1102.5333786010742L265.99998474121094 1128.5333786010742L188.99998474121094 1128.5333786010742" stroke-dasharray="10,5,3,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1255)"></path></g><g id="SvgjsG1257"><path id="SvgjsPath1258" d="M100.99998474121094 1209.5333786010742L130.99998474121094 1209.5333786010742L131.93333435058594 1274.3666763305664L101.93333435058594 1274.3666763305664" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1259)"></path><rect id="SvgjsRect1261" width="84" height="16" x="89.46665954589844" y="1233.9500274658203" fill="#ffffff"></rect><text id="SvgjsText1262" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="84px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1232.0000274658203" transform="rotate(0)"><tspan id="SvgjsTspan1263" dy="16" x="131.46665954589844"><tspan id="SvgjsTspan1264" style="text-decoration:;">sortAndSpill()</tspan></tspan></text></g><g id="SvgjsG1265" transform="translate(365.79998779296875,1169.3523712158203)"><path id="SvgjsPath1266" d="M 0 0L 443.1999969482422 0L 459.1999969482422 16L 459.1999969482422 191.51432037353516L 0 191.51432037353516L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1267" d="M 443.1999969482422 0L 443.1999969482422 16L 459.1999969482422 16" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1268" d="M 0 0L 443.1999969482422 0L 459.1999969482422 16L 459.1999969482422 191.51432037353516L 0 191.51432037353516L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1269"><text id="SvgjsText1270" font-family="微软雅黑" text-anchor="start" font-size="13px" width="440px" fill="#323232" font-weight="400" align="middle" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="37.807160186767575" transform="rotate(0)"><tspan id="SvgjsTspan1271" dy="16" x="10"><tspan id="SvgjsTspan1272" style="text-decoration:;">它是溢写线程中进行二次排序的方法等操作朱啊哟的工作主是：</tspan></tspan><tspan id="SvgjsTspan1273" dy="16" x="10"><tspan id="SvgjsTspan1274" style="text-decoration:;">1.第一次排序对partition分区号进行排序，方便</tspan></tspan><tspan id="SvgjsTspan1275" dy="16" x="10"><tspan id="SvgjsTspan1276" style="text-decoration:;">    reduce拉取的时候能快速定位自己的分区</tspan></tspan><tspan id="SvgjsTspan1277" dy="16" x="10"><tspan id="SvgjsTspan1278" style="text-decoration:;">2. 第二次排序对分区中的key进行排序，目的是方便 reduce拉取数据的时候</tspan></tspan><tspan id="SvgjsTspan1279" dy="16" x="10"><tspan id="SvgjsTspan1280" style="text-decoration:;">可以顺序读一次      文件</tspan><tspan id="SvgjsTspan1281" style="text-decoration:;font-size: inherit;">把所有的数据都拉取完</tspan></tspan><tspan id="SvgjsTspan1282" dy="16" x="10"><tspan id="SvgjsTspan1283" style="text-decoration:;font-size: inherit;">3.如果有combine步骤的话，还会做combine</tspan></tspan><tspan id="SvgjsTspan1284" dy="16" x="10"><tspan id="SvgjsTspan1285" style="text-decoration:;font-size: inherit;">4.整个环形缓冲区的实现也是它实现的</tspan></tspan></text></g></g><g id="SvgjsG1286"><path id="SvgjsPath1287" d="M360.99998474121094 1239.8666915893555L266.49998474121094 1239.8666915893555L266.49998474121094 1239.8666915893555L171.99998474121094 1239.8666915893555" stroke-dasharray="10,5,3,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1288)"></path></g></svg>