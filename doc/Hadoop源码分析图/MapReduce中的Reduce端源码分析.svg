<svg id="SvgjsSvg1006" width="1174.550048828125" height="1374" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1037" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1038" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1065" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1066" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1093" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1094" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1101" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1102" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1121" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1122" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1131" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1132" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1135" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1136" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1139" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1140" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1143" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1144" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1008" transform="translate(25.01666259765625,35.99999237060547)"><path id="SvgjsPath1009" d="M 48.566673278808594 30L 48.566673278808594 1312.809534890311" stroke-dasharray="3,4" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1010" d="M 0 0L 97.13334655761719 0L 97.13334655761719 30L 0 30Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1011"><text id="SvgjsText1012" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="78px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="5.05" transform="rotate(0)"><tspan id="SvgjsTspan1013" dy="16" x="49"><tspan id="SvgjsTspan1014" style="text-decoration:;">ReduceTask</tspan></tspan></text></g></g><g id="SvgjsG1015" transform="translate(61.15000915527344,89.99999237060547)"><path id="SvgjsPath1016" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 1096.5333557128906Q 30 1100.5333557128906 26 1100.5333557128906L 4 1100.5333557128906Q 0 1100.5333557128906 0 1096.5333557128906L 0 4Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1017" transform="translate(527.1500091552734,24.99999237060547)"><path id="SvgjsPath1018" d="M 68.5 30L 68.5 780.9999694824219" stroke-dasharray="3,4" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1019" d="M 0 0L 137 0L 137 30L 0 30Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1020"><text id="SvgjsText1021" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="117px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="5.05" transform="rotate(0)"><tspan id="SvgjsTspan1022" dy="16" x="68.5"><tspan id="SvgjsTspan1023" style="text-decoration:;">Shuffle</tspan></tspan></text></g></g><g id="SvgjsG1024" transform="translate(580.6500091552734,393.99999237060547)"><path id="SvgjsPath1025" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 178.00000381469727Q 30 182.00000381469727 26 182.00000381469727L 4 182.00000381469727Q 0 182.00000381469727 0 178.00000381469727L 0 4Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1026" transform="translate(756.75,27.66661834716797)"><path id="SvgjsPath1027" d="M 69.73332977294922 30L 69.73332977294922 843.800048828125" stroke-dasharray="3,4" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><path id="SvgjsPath1028" d="M 0 0L 139.46665954589844 0L 139.46665954589844 30L 0 30Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1029"><text id="SvgjsText1030" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="120px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="5.05" transform="rotate(0)"><tspan id="SvgjsTspan1031" dy="16" x="70"><tspan id="SvgjsTspan1032" style="text-decoration:;">JobConf</tspan></tspan></text></g></g><g id="SvgjsG1033" transform="translate(806.9500045776367,611.9999961853027)"><path id="SvgjsPath1034" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 196.8095272609164Q 30 200.8095272609164 26 200.8095272609164L 4 200.8095272609164Q 0 200.8095272609164 0 196.8095272609164L 0 4Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1035"><path id="SvgjsPath1036" d="M89.01666259765625 130.35157442078162L119.01666259765625 130.35157442078162L121.01666259765625 274.92743435865157L91.01666259765625 274.92743435865157" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1037)"></path><rect id="SvgjsRect1039" width="30" height="16" x="105.01666259765625" y="194.6395043897166" fill="#ffffff"></rect><text id="SvgjsText1040" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="30px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="192.6895043897166" transform="rotate(0)"><tspan id="SvgjsTspan1041" dy="16" x="120.01666259765625"><tspan id="SvgjsTspan1042" style="text-decoration:;">run()</tspan></tspan></text></g><g id="SvgjsG1043" transform="translate(206.5663330700935,49.95236968994067)"><path id="SvgjsPath1044" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1045" d="M 284.63809858049626 0L 284.63809858049626 16L 300.63809858049626 16" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1046" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1047"><text id="SvgjsText1048" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="281px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="6.873810577392606" transform="rotate(0)"><tspan id="SvgjsTspan1049" dy="16" x="150.5"><tspan id="SvgjsTspan1050" style="text-decoration:;">我们在写MR任务的时候，一般必须写的就是</tspan></tspan><tspan id="SvgjsTspan1051" dy="16" x="150.5"><tspan id="SvgjsTspan1052" style="text-decoration:;">Map和Reduce类，我们点进继承类Reduce类，</tspan></tspan><tspan id="SvgjsTspan1053" dy="16" x="150.5"><tspan id="SvgjsTspan1054" style="text-decoration:;">看类的注释可以发现，reduce一共有3个阶段，</tspan></tspan><tspan id="SvgjsTspan1055" dy="16" x="150.5"><tspan id="SvgjsTspan1056" style="text-decoration:;">分别是，shuffle，sort，reduce</tspan><tspan id="SvgjsTspan1057" style="text-decoration:;font-size: inherit;">。</tspan><tspan id="SvgjsTspan1058" style="text-decoration:;font-size: inherit; font-weight: bold;fill: rgb(255, 0, 0);">由他我们找下</tspan></tspan><tspan id="SvgjsTspan1059" dy="16" x="150.5"><tspan id="SvgjsTspan1060" style="text-decoration:;font-size: inherit; font-weight: bold;fill: rgb(255, 0, 0);">MapTask类中对应的run()它对应的也应该整个</tspan></tspan><tspan id="SvgjsTspan1061" dy="16" x="150.5"><tspan id="SvgjsTspan1062" style="text-decoration:;font-size: inherit; font-weight: bold;fill: rgb(255, 0, 0);">reduce环节的重点</tspan></tspan></text></g></g><g id="SvgjsG1063"><path id="SvgjsPath1064" d="M91.01666259765625 442.22227720554025L332.11666107177734 442.22227720554025L332.11666107177734 422.53331756591797L573.2166595458984 422.53331756591797" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1065)"></path><rect id="SvgjsRect1067" width="268" height="48" x="198.11666107177734" y="408.3777973857291" fill="#ffffff"></rect><text id="SvgjsText1068" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="268px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="406.4277973857291" transform="rotate(0)"><tspan id="SvgjsTspan1069" dy="16" x="332.11666107177734"><tspan id="SvgjsTspan1070" style="text-decoration:;">run()中调用shuffle类中的</tspan></tspan><tspan id="SvgjsTspan1071" dy="16" x="332.11666107177734"><tspan id="SvgjsTspan1072" style="text-decoration:;">shuffleConsumerPlugin.run()</tspan></tspan><tspan id="SvgjsTspan1073" dy="16" x="332.11666107177734"><tspan id="SvgjsTspan1074" style="text-decoration:;">得到rIter，迭代器，它相当于map阶段的input</tspan></tspan></text></g><g id="SvgjsG1075" transform="translate(221.5663330700935,221.35237121582026)"><path id="SvgjsPath1076" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1077" d="M 284.63809858049626 0L 284.63809858049626 16L 300.63809858049626 16" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1078" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1079"><text id="SvgjsText1080" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="281px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="14.873810577392607" transform="rotate(0)"><tspan id="SvgjsTspan1081" dy="16" x="150.5"><tspan id="SvgjsTspan1082" style="text-decoration:;">接下来由Reduce端的三个环节：</tspan></tspan><tspan id="SvgjsTspan1083" dy="16" x="150.5"><tspan id="SvgjsTspan1084" style="text-decoration:;">1. shuffle环节</tspan></tspan><tspan id="SvgjsTspan1085" dy="16" x="150.5"><tspan id="SvgjsTspan1086" style="text-decoration:;">2. sort环节</tspan></tspan><tspan id="SvgjsTspan1087" dy="16" x="150.5"><tspan id="SvgjsTspan1088" style="text-decoration:;">3.reduce阶段</tspan></tspan><tspan id="SvgjsTspan1089" dy="16" x="150.5"><tspan id="SvgjsTspan1090" style="text-decoration:;">由它们完成reduce端对应的功能语义实现</tspan></tspan></text></g></g><g id="SvgjsG1091"><path id="SvgjsPath1092" d="M610.0166625976562 409.0575489338175L640.0166625976562 409.0575489338175L640.0166625976562 544.9999961853027L610.0166625976562 544.9999961853027" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1093)"></path><rect id="SvgjsRect1095" width="30" height="16" x="625.0166625976562" y="469.02877255956014" fill="#ffffff"></rect><text id="SvgjsText1096" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="30px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="467.07877255956015" transform="rotate(0)"><tspan id="SvgjsTspan1097" dy="16" x="640.0166625976562"><tspan id="SvgjsTspan1098" style="text-decoration:;">run()</tspan></tspan></text></g><g id="SvgjsG1099"><path id="SvgjsPath1100" d="M835.2166595458984 670.1333265304565L865.2166595458984 670.1333265304565L866.0166625976562 798.3333358764648L836.0166625976562 798.3333358764648" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1101)"></path><rect id="SvgjsRect1103" width="234" height="16" x="748.6166610717773" y="726.2333312034607" fill="#ffffff"></rect><text id="SvgjsText1104" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="234px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="724.2833312034606" transform="rotate(0)"><tspan id="SvgjsTspan1105" dy="16" x="865.6166610717773"><tspan id="SvgjsTspan1106" style="text-decoration:;">getOutputValueGroupingComparator</tspan></tspan></text></g><g id="SvgjsG1107" transform="translate(849.5663330700936,438.3523712158203)"><path id="SvgjsPath1108" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1109" d="M 284.63809858049626 0L 284.63809858049626 16L 300.63809858049626 16" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffff33"></path><path id="SvgjsPath1110" d="M 0 0L 284.63809858049626 0L 300.63809858049626 16L 300.63809858049626 113.64762115478521L 0 113.64762115478521L 0 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1111"><text id="SvgjsText1112" font-family="微软雅黑" text-anchor="start" font-size="13px" width="281px" fill="#323232" font-weight="400" align="top" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.05" transform="rotate(0)"><tspan id="SvgjsTspan1113" dy="16" x="10"><tspan id="SvgjsTspan1114" style="text-decoration:;">得到分组比较器，取值的方法是：</tspan></tspan><tspan id="SvgjsTspan1115" dy="16" x="10"><tspan id="SvgjsTspan1116" style="text-decoration:;">如果用户定义了，就用用户的，如果用户没有定</tspan></tspan><tspan id="SvgjsTspan1117" dy="16" x="10"><tspan id="SvgjsTspan1118" style="text-decoration:;">义就直接用key的排序比较器来做分组比较器</tspan></tspan></text></g></g><g id="SvgjsG1119"><path id="SvgjsPath1120" d="M90.21665954589844 759.5333480834961L120.21665954589844 759.5333480834961L120.21665954589844 850.5333480834961L90.21665954589844 850.5333480834961" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1121)"></path><rect id="SvgjsRect1123" width="109" height="32" x="65.71665954589844" y="789.0333480834961" fill="#ffffff"></rect><text id="SvgjsText1124" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="109px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="787.083348083496" transform="rotate(0)"><tspan id="SvgjsTspan1125" dy="16" x="120.21665954589844"><tspan id="SvgjsTspan1126" style="text-decoration:;">runNewReducer()</tspan></tspan><tspan id="SvgjsTspan1127" dy="16" x="120.21665954589844"><tspan id="SvgjsTspan1128" style="text-decoration:;">开始跑reduce环节</tspan></tspan></text></g><g id="SvgjsG1129"><path id="SvgjsPath1130" d="M934.2166595458984 551.9999923706055L885.2166595458984 551.9999923706055L885.2166595458984 641.1333265304565L836.2166595458984 641.1333265304565" stroke-dasharray="10,5,3,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1131)"></path></g><g id="SvgjsG1133"><path id="SvgjsPath1134" d="M362.21665954589844 342.1999740600586L362.21665954589844 377.1999740600586L362.21665954589844 377.1999740600586L362.21665954589844 412.1999740600586" stroke-dasharray="10,5,3,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1135)"></path></g><g id="SvgjsG1137"><path id="SvgjsPath1138" d="M199.21665954589844 105.86663055419922L144.71665954589844 105.86663055419922L144.71665954589844 105.86663055419922L90.21665954589844 105.86663055419922" stroke-dasharray="10,5,3,5" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1139)"></path></g><g id="SvgjsG1141"><path id="SvgjsPath1142" d="M91.15000915527344 640.2666702270508L444.18333435058594 640.2666702270508L444.18333435058594 640.2666702270508L797.2166595458984 640.2666702270508" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1143)"></path></g></svg>